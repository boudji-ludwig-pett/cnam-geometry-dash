@startuml acitvity-diagram
start

:Lancer la partie;

repeat
    if (Le joueur percute un obstacle ?) then (Oui)
        :Le joueur meurt;
        :Animation de mort;
        :Augmenter le nombre d'essais de 1;
        :Perdre toutes les pièces et bonus;
    else (Non)
        ' --- Première Ligne ---
        partition "Saut" {
            if (L'utilisateur clique sur l'écran ?) then (Oui)
                :Le joueur effectue un saut;
            endif
        }

        partition "Bumper" {
            if (Le joueur touche un bumper ?) then (Oui)
                :Le joueur effectue un grand saut;
                note right
                Voir [[./sub_bumper.puml Bumper Logic]].
                end note
            endif
        }

        partition "Forme" {
            if (Le joueur passe un portail ?) then (Oui)
                :Changement de forme;
                note right
                Voir [[./sub_forme.puml Forme Details]].
                end note
            endif
        }

        partition "Bonus" {
            if (Le joueur touche un bonus ?) then (Oui)
                :Ajouter le bonus à l'inventaire;
                note right
                Voir [[./sub_bonus.puml Bonus Logic]].
                end note
            endif

            if (Le joueur clique sur un bonus dans son inventaire ?) then (Oui)
                :Activer un bonus;
                note right
                Voir [[./sub_activation_bonus.puml Bonus Activation]].
                end note
            endif
        }

        partition "Collecte des Pièces" {
            if (Le joueur touche une pièce ?) then (Oui)
                :Ajouter la pièce au niveau;
                note right
                Voir [[./sub_pieces.puml Pièces Collection]].
                end note
            endif
        }
    endif

    ' --- Fin du Niveau ---
    partition "Fin du Niveau" {
        if (Le joueur touche la zone de fin ?) then (Oui)
            :Terminer le niveau;
            :Animation de fin de niveau;
            :Conserver les pièces obtenues;
            break
        endif
    }

repeat while (Le joueur n'a pas fini le niveau)

stop
@enduml
